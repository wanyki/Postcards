<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜ä¿¡ç‰‡æ¡£æ¡ˆè¯¦æƒ…ğŸ“®</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --primary: #4361ee;
            --bg: #f8f9fc;
            --text-main: #2d3436;
        }

        body { 
            background-color: var(--bg); 
            font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif; 
            color: var(--text-main);
            /* æ‰‹æœºç«¯é¡¶éƒ¨é—´è·å‡å° */
            padding: 0 0 40px; 
        }

        /* å“åº”å¼å¯¼èˆª */
        .glass-header {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            position: sticky; top: 0; z-index: 100;
            padding: 12px 0; margin-bottom: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.08);
        }

        .detail-card { 
            background: white; border-radius: 24px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.06); 
            overflow: hidden; border: none;
            margin-bottom: 20px;
        }

        /* å›¾ç‰‡åŒºåŸŸå“åº”å¼ */
        .image-side {
            background: #f1f3f5;
            display: flex; align-items: center; justify-content: center;
            padding: 20px; /* æ‰‹æœºç«¯å‡å°å†…è¾¹è· */
            min-height: 350px;
        }
        .img-wrapper {
            position: relative;
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            border-radius: 12px; transition: transform 0.3s; cursor: zoom-in;
            width: 100%; /* æ‰‹æœºç«¯å®½åº¦å æ»¡ */
            max-width: fit-content;
        }
        .img-wrapper img { 
            width: 100%; height: auto; 
            max-height: 70vh; /* é˜²æ­¢å›¾ç‰‡è¿‡é•¿ */
            border-radius: 12px; display: block;
        }

        /* ä¿¡æ¯åŒºåŸŸå“åº”å¼ */
        .info-side { padding: 30px 20px; } /* é»˜è®¤æ‰‹æœºç«¯è¾¹è· */
        
        @media (min-width: 992px) {
            body { padding-top: 30px; }
            .info-side { padding: 50px 45px; }
            .image-side { padding: 40px; min-height: 550px; }
        }

        /* ID æ ‡ç­¾ */
        .badge-id { 
            font-family: "Courier New", Courier, monospace;
            background: #2d3436; color: #ffffff;
            padding: 5px 14px; border-radius: 8px;
            font-size: 0.9rem; font-weight: 700;
            display: inline-block; margin-bottom: 15px;
        }

        .user-region-title {
            font-size: 1.8rem; font-weight: 800;
            color: #1a1a1a; margin-bottom: 10px; line-height: 1.2;
        }
        @media (min-width: 768px) { .user-region-title { font-size: 2.4rem; } }

        /* æ¼‚æµç›’å“åº”å¼ */
        .drift-box {
            background: #f8faff; border: 1px solid #e0e7ff;
            border-radius: 20px; padding: 20px; margin-bottom: 25px;
        }
        .drift-line { height: 1px; background: #cbd5e1; position: relative; margin: 15px 0; }
        .drift-line::after {
            content: "âœˆï¸"; position: absolute; left: 50%; top: 50%;
            transform: translate(-50%, -55%); background: #f8faff; padding: 0 8px;
        }

        /* ä¿¡æ¯ç½‘æ ¼å“åº”å¼ï¼šæ‰‹æœº 1 åˆ—ï¼Œå¹³æ¿ 2 åˆ— */
        .info-grid { 
            display: grid; 
            grid-template-columns: 1fr; 
            gap: 15px; 
            margin-bottom: 25px; 
        }
        @media (min-width: 576px) { .info-grid { grid-template-columns: 1fr 1fr; } }

        .info-item label { display: block; font-size: 0.75rem; color: #7f8c8d; font-weight: 700; margin-bottom: 4px; text-transform: uppercase; }
        .info-item span { font-weight: 600; color: #2c3e50; font-size: 1rem; }

        /* å¿ƒæƒ…åŒºåŸŸ */
        .note-area {
            background: #fffdf5; border-left: 4px solid #ffeaa7;
            padding: 15px; color: #4b4b4b; line-height: 1.7; font-size: 0.95rem;
        }

        /* æ ‡ç­¾ */
        .tag-pill {
            background: white; color: var(--primary);
            padding: 4px 10px; border-radius: 6px; margin-right: 6px;
            margin-bottom: 8px; font-size: 0.8rem; 
            border: 1px solid #d1d9ff; display: inline-block;
        }

        /* æ¨¡æ€æ¡†å›¾ç‰‡è‡ªé€‚åº” */
        #imgModal img { width: 95%; height: auto; max-height: 90vh; }
    </style>
</head>
<body>

<header class="glass-header shadow-sm">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
            <span class="fs-5 me-2">ğŸ“®</span>
            <h6 class="mb-0 fw-bold d-none d-sm-block">æ˜ä¿¡ç‰‡æ¡£æ¡ˆ</h6>
            <h6 class="mb-0 fw-bold d-block d-sm-none">æ¡£æ¡ˆè¯¦æƒ…</h6>
        </div>
        <a href="index.html" class="btn btn-outline-dark rounded-pill px-3 btn-sm">
            <i class="bi bi-arrow-left"></i> è¿”å›
        </a>
    </div>
</header>

<div class="container">
    <div id="detail-root">
        </div>
</div>

<div id="imgModal" style="position:fixed; inset:0; background:rgba(0,0,0,0.9); display:none; align-items:center; justify-content:center; z-index:2000;" onclick="this.style.display='none'">
    <img id="imgModalImg" src="" style="border-radius:8px;">
</div>

<script src="data.js"></script>
<script>
    function getQueryId() {
        return new URLSearchParams(window.location.search).get('id');
    }

    function getDriftDays(s, r) {
        if (!s || !r) return null;
        const diff = Math.floor((new Date(r) - new Date(s)) / (1000 * 60 * 60 * 24));
        return diff >= 0 ? diff : 0;
    }

    function render() {
        const id = getQueryId();
        const root = document.getElementById('detail-root');
        if (typeof postcardData === 'undefined') return;

        const card = postcardData.find(c => c.id === id);
        if (!card) {
            root.innerHTML = `<div class="text-center py-5"><h5>æ¡£æ¡ˆæœªæ‰¾åˆ°</h5><a href="index.html" class="btn btn-primary mt-3">è¿”å›ä¸»é¡µ</a></div>`;
            return;
        }

        const drift = getDriftDays(card.sendDate, card.receiveDate);
        const tags = Array.isArray(card.tags) ? card.tags : [];

        root.innerHTML = `
            <div class="detail-card">
                <div class="row g-0">
                    <div class="col-lg-7 image-side">
                        <div class="img-wrapper" onclick="document.getElementById('imgModalImg').src=this.querySelector('img').src; document.getElementById('imgModal').style.display='flex'">
                            <img src="${card.imgFront}" alt="Postcard">
                        </div>
                    </div>

                    <div class="col-lg-5 info-side">
                        <div class="badge-id">ID: ${card.id}</div>
                        
                        <h2 class="user-region-title">${card.person || 'ä½šå'} - ${card.region}</h2>
                        
                        <div class="d-flex gap-2 mb-4">
                            <span class="badge bg-light text-primary border px-3 py-2 rounded-pill">ğŸ“ ${card.country || 'ä¸­å›½'}</span>
                            <span class="badge ${card.type === 'æ”¶åˆ°' ? 'bg-success' : 'bg-primary'} rounded-pill px-3 py-2">${card.type}</span>
                        </div>

                        <div class="drift-box">
                            <div class="row text-center g-0">
                                <div class="col-5">
                                    <label>Sent</label>
                                    <div class="fw-bold">${card.sendDate || 'â€”'}</div>
                                </div>
                                <div class="col-2 d-flex align-items-center justify-content-center">
                                    <i class="bi bi-arrow-right-short text-muted fs-4"></i>
                                </div>
                                <div class="col-5">
                                    <label>Received</label>
                                    <div class="fw-bold">${card.receiveDate || 'â€”'}</div>
                                </div>
                            </div>
                            <div class="drift-line"></div>
                            <div class="text-center">
                                ${drift !== null ? 
                                    `<span class="fw-bold text-primary small"><i class="bi bi-clock-fill me-1"></i> æ¼‚æµæ—…ç¨‹ï¼š${drift} å¤©</span>` : 
                                    `<span class="text-muted small">æ¼‚æµæ—¶é—´ä¸è¯¦</span>`
                                }
                            </div>
                        </div>

                        <div class="info-grid">
                            <div class="info-item">
                                <label>æ¥æºå¹³å°</label>
                                <span><i class="bi bi-globe2 me-2"></i>${card.platform || 'ä¸ªäººäº¤æ¢'}</span>
                            </div>
                            <div class="info-item">
                                <label>å…³è”äººç‰©</label>
                                <span><i class="bi bi-person-heart me-2"></i>${card.person || 'æœªçŸ¥'}</span>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="small text-muted fw-bold mb-2 d-block">æ¡£æ¡ˆå¤‡æ³¨</label>
                            <div class="note-area">
                                ${card.note || 'è¿™å°ä¿¡é™é™åœ°èººåœ¨æ—¶å…‰é‡Œï¼Œæ²¡æœ‰ç•™ä¸‹é¢å¤–çš„åªè¨€ç‰‡è¯­ã€‚'}
                            </div>
                        </div>

                        <div class="tag-container">
                            ${tags.map(t => `<span class="tag-pill"># ${t}</span>`).join('')}
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    window.onload = render;
</script>
</body>
</html>
